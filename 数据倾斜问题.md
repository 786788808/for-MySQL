遇上数据倾斜问题，该如何优化呢？  

### 目录： 
- 什么是数据倾斜
- 数据倾斜的表现  
- 原因分析
- 解决方法

在讲这个问题前，首先得知道 map shuffle reduce key value 等等概念，大概明白整个流程是怎样的。  

## 1. 什么是数据倾斜
在并行处理的数据集中，由于数据分布不匀，某一部分的数据显著多于其它部分，从而使得该部分数据的处理速度远慢于其他部分数据的处理速度。   

## 2. 数据倾斜的表现
- 任务进度条长时间维持在 99% 左右，任务监控页面显示只剩几个 reduce 任务未完成，这部分处理的数据量比其他的总量都要大。
- 存在处理某一 reduce 任务的时长比平均时长还长

## 3. 原因分析
- key分布不均匀
- 业务数据本身的特性
- 建表时考虑不周
- 某些SQL语句本身就有数据倾斜

countdistinct、group by、join等操作，  
|  操作   | 情况  |  结果 |
|  ----  | ----  | ----  |
| 单元格  | 单元格 | 单元格 |
| 单元格  | 单元格 | 单元格 |
| 单元格  | 单元格 | 单元格 |



